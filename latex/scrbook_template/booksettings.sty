\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{booksettings}[2025/08/24 Unified template for KOMA and standard classes]

\usepackage{../settings}

%===========================================================================================
% layout and formatting options (depending on documentclass)
%===========================================================================================

\RequirePackage{etoolbox}

% 1. test if KOMA-Script was loaded
\newif\ifIsKOMA
\ifdef{\KOMAClassName}{\IsKOMAtrue}{\IsKOMAfalse}

%-----------------------------------------------------------------------
% 2. if KOMA-Script: set options
\ifIsKOMA
  %--------------------------------------
  % format
  %--------------------------------------

  \KOMAoptions{
  paper=a4,
  fontsize=12pt,
  %DIV=12,       % Satzspiegel-Teilung (höher = schmalere Ränder)
  %BCOR=10mm     % Bundstegkorrektur für Bindung
  }

  %--------------------------------------
  % header and footer
  %--------------------------------------

  \RequirePackage[automark,headsepline]{scrlayer-scrpage}
  \clearpairofpagestyles

  \automark[section]{chapter} % füllt \leftmark (Kapitel) und \rightmark (Section)

  % outer header: even = Chapter outer left, odd = Section outer right
  \ohead{\ifthispageodd{\slshape\rightmark}{\slshape\leftmark}}

  % outer footer
  \ofoot{\pagemark}

  %--------------------------------------
  % text and captions
  %--------------------------------------

  % indentation paragraph
  \setlength\parindent{15pt}

  % settings captions
  \setkomafont{captionlabel}{\sffamily\bfseries}
  % indentation caption
  \setcapindent{0em}

%-----------------------------------------------------------------------
\else
  % 3. if standard classes: load packages for layout and header
  \RequirePackage{geometry}
  \geometry{
    a4paper,
    left=25mm,
    right=25mm,
    top=25mm,
    bottom=20mm,
    headheight=15pt,
  }

  %--------------------------------------
  % header and footer
  %--------------------------------------

  \RequirePackage{fancyhdr}

	\pagestyle{fancy}
	\fancyhf{}
  \setlength{\headheight}{15pt}
	\fancyhead[LE]{\slshape\nouppercase{\leftmark}}
	\fancyhead[RO]{\slshape\nouppercase{\rightmark}} 
	%\fancyhead[RO]{\slshape\nouppercase{\leftmark}}
	\fancyfoot[LE, RO]{\thepage}

  % use
  % \thispagestyle{empty}
  % to remove header/footer on specific pages

  %--------------------------------------
  % text and captions
  %--------------------------------------

  % Optional: Zeilenabstand zwischen Absätzen
  \setlength{\parskip}{0.5\baselineskip}
  \setlength{\parindent}{15pt}

  \RequirePackage{caption}
  \captionsetup[figure]{labelfont={bf,sf}}
  \captionsetup[table]{labelfont={bf,sf}}
\fi

%===========================================================================================
% text options
%===========================================================================================

\usepackage{lmodern}
\setstretch{1.25}

\RequirePackage[ngerman, english]{babel}

%===========================================================================================
% math options
%===========================================================================================

\sisetup{exponent-product = \cdot}

\numberwithin{equation}{subsection}

%===========================================================================================
% others
%===========================================================================================

% Adjust numbering depth and TOC depth here
\setcounter{secnumdepth}{1} % Number only to \subsection
\setcounter{tocdepth}{1}    % Show down to \paragraph in TOC

\numberwithin{figure}{section}
